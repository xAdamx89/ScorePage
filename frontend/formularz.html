<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Dodaj wpis punktów</title>
</head>
<body>
     <input type="button" value="Powrót" onclick="window.location.href='index.html'">
    <h1>Dodaj nowy wpis punktów</h1>
    <form id="wpisForm">
        <label for="klasa_ucznia">Klasa ucznia:</label>
        <input type="text" id="klasa_ucznia" name="klasa_ucznia" required><br><br>

        <label for="numer_ucznia">Numer ucznia:</label>
        <input type="number" id="numer_ucznia" name="numer_ucznia" required><br><br>

        <label for="uzyskane_punkty">Uzyskane punkty:</label>
        <input type="number" id="uzyskane_punkty" name="uzyskane_punkty" required><br><br>

        <label for="opis_zadania">Opis zadania:</label><br>
        <textarea id="opis_zadania" name="opis_zadania" rows="3" cols="50" required></textarea><br><br>

        <label for="mozliwe_pkt_do_uzyskania">Możliwe punkty do uzyskania:</label>
        <input type="number" id="mozliwe_pkt_do_uzyskania" name="mozliwe_pkt_do_uzyskania" required><br><br>

        <label for="przedmiot">Przedmiot:</label>
        <input type="text" id="przedmiot" name="przedmiot" required><br><br>

        <button type="submit">Dodaj wpis</button>
    </form>

    <p id="status"></p>

    <script>
        const form = document.getElementById('wpisForm');
        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const data = {
                klasa_ucznia: document.getElementById('klasa_ucznia').value,
                numer_ucznia: parseInt(document.getElementById('numer_ucznia').value),
                uzyskane_punkty: parseInt(document.getElementById('uzyskane_punkty').value),
                opis_zadania: document.getElementById('opis_zadania').value,
                data_wpisu: new Date().toISOString().split('T')[0], // aktualna data jako tekst YYYY-MM-DD
                mozliwe_pkt_do_uzyskania: parseInt(document.getElementById('mozliwe_pkt_do_uzyskania').value),
                przedmiot: document.getElementById('przedmiot').value
            };

            try {
                const response = await fetch('http://fastpapi.adam-mazurek.pl/wpisy_punktow', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    document.getElementById('status').textContent = 'Wpis dodany!';
                    form.reset();
                } else {
                    const errData = await response.json();
                    document.getElementById('status').textContent = 'Błąd: ' + errData.detail;
                }
            } catch (err) {
                document.getElementById('status').textContent = 'Błąd sieci: ' + err;
            }
        });
    </script>
</body>
</html>
