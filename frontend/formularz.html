<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Dodaj wpis punktów</title>
    <style>
        table { border-collapse: collapse; width: 80%; margin: 20px auto; }
        th, td { border: 1px solid #333; padding: 8px; text-align: center; }
        th { background-color: #f2f2f2; }
    </style>
</head>
<body>
     <input type="button" value="Powrót" onclick="window.location.href='index.html'">
    <h1>Dodaj nowy wpis punktów</h1>
    <form id="wpisForm">
        <label for="klasa_ucznia">Klasa ucznia:</label>
        <input type="text" id="klasa_ucznia" name="klasa_ucznia" required><br><br>

        <label for="numer_ucznia">Numer ucznia:</label>
        <input type="number" id="numer_ucznia" name="numer_ucznia" required><br><br>

        <label for="uzyskane_punkty">Uzyskane punkty:</label>
        <input type="number" id="uzyskane_punkty" name="uzyskane_punkty" required><br><br>

        <label for="opis_zadania">Opis zadania:</label><br>
        <textarea id="opis_zadania" name="opis_zadania" rows="3" cols="50" required></textarea><br><br>

        <label for="mozliwe_pkt_do_uzyskania">Możliwe punkty do uzyskania:</label>
        <input type="number" id="mozliwe_pkt_do_uzyskania" name="mozliwe_pkt_do_uzyskania" required><br><br>

        <label for="przedmiot">Przedmiot:</label>
        <input type="text" id="przedmiot" name="przedmiot" required><br><br>

        <button type="submit">Dodaj wpis</button>
    </form>

    <p id="status"></p>

    <h2 style="text-align:center;">Punkty uzyskane na zajeciach</h2><br>
    <h3>Proszę zaznaczyć następujące parametry:</h3>
    <form id="formularz">
        <table>
            <tr>
                <th>klasa</th>
                <th>Przedmiot</th>
                <th>Numer w dzienniku</th>
            </tr>
                <td>
                    <input type="radio" id="klasa1" name="klasa" value="1g">
                    <label for="klasa1">1g</label><br>

                    <input type="radio" id="klasa2" name="klasa" value="2g">
                    <label for="klasa2">2g</label><br>

                    <input type="radio" id="klasa3" name="klasa" value="3g">
                    <label for="klasa3">3g</label><br>

                    <input type="radio" id="klasa4" name="klasa" value="4g">
                    <label for="klasa4">4g</label><br>

                    <input type="radio" id="klasa5" name="klasa" value="5g">
                    <label for="klasa5">5g</label><br>
                </td>

                <td style="text-align:left">
                    <input type="radio" id="przedmiot1" name="przedmiot" value="Azr">
                    <label for="przedmiot1">Azr - Aplikacje zrobotyzowane</label><br>

                    <input type="radio" id="przedmiot2" name="przedmiot" value="PiER">
                    <label for="przedmiot2">PiER - Programowanie i eksploatacja robotów</label><br>

                    <input type="radio" id="przedmiot3" name="przedmiot" value="PPiEP">
                    <label for="przedmiot3">PPiEP - Prac. pneum. i elepnem.</label><br>

                    <input type="radio" id="przedmiot4" name="przedmiot" value="ProgRob">
                    <label for="przedmiot4">ProgRob - Programowanie robotów</label><br>

                    <input type="radio" id="przedmiot5" name="przedmiot" value="PRob">
                    <label for="przedmiot5">PRob - Podstawy robotyki</label><br>
                </td>
                <td>
                    <input type="number" id="Numer" name="Numer" min="1" max="31" step="1" value="1">
                </td>
        </table>
        <input type="submit" value="Sprawdź punkty">
    </form>

    <script>
        const form = document.getElementById('wpisForm');
        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const data = {
                klasa_ucznia: document.getElementById('klasa_ucznia').value,
                numer_ucznia: parseInt(document.getElementById('numer_ucznia').value),
                uzyskane_punkty: parseInt(document.getElementById('uzyskane_punkty').value),
                opis_zadania: document.getElementById('opis_zadania').value,
                data_wpisu: new Date().toISOString().split('T')[0], // aktualna data jako tekst YYYY-MM-DD
                mozliwe_pkt_do_uzyskania: parseInt(document.getElementById('mozliwe_pkt_do_uzyskania').value),
                przedmiot: document.getElementById('przedmiot').value
            };

            try {
                const response = await fetch('https://fastapi.adam-mazurek.pl/wpisy_punktow', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                if (response.ok) {
                    document.getElementById('status').textContent = 'Wpis dodany!';
                    form.reset();
                } else {
                    const errData = await response.json();
                    document.getElementById('status').textContent = 'Błąd: ' + errData.detail;
                }
            } catch (err) {
                document.getElementById('status').textContent = 'Błąd sieci: ' + err;
            }
        });
    </script>
</body>
</html>
